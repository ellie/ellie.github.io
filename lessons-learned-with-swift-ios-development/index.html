<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Lessons learned with Swift + iOS development | Ellie's Blog</title><meta name=keywords content><meta name=description content="I&rsquo;ve been writing a lot of Swift and SwiftUI lately, here&rsquo;s what I have learned"><meta name=author content="Ellie Huxtable"><link rel=canonical href=https://ellie.wtf/lessons-learned-with-swift-ios-development/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.74de712ebf99671816ff9154a698aa240865ce6e4819509c4fb7a7b323dee954.css integrity="sha256-dN5xLr+ZZxgW/5FUppiqJAhlzm5IGVCcT7ensyPe6VQ=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://ellie.wtf/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://ellie.wtf/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://ellie.wtf/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://ellie.wtf/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://ellie.wtf/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Alata&family=Cardo&display=swap" rel=stylesheet><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Lessons learned with Swift + iOS development"><meta property="og:description" content="I&rsquo;ve been writing a lot of Swift and SwiftUI lately, here&rsquo;s what I have learned"><meta property="og:type" content="article"><meta property="og:url" content="https://ellie.wtf/lessons-learned-with-swift-ios-development/"><meta property="article:section" content="post"><meta property="article:published_time" content="2020-01-29T14:00:13+00:00"><meta property="article:modified_time" content="2020-01-29T14:00:13+00:00"><meta property="og:site_name" content="Ellie's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Lessons learned with Swift + iOS development"><meta name=twitter:description content="I&rsquo;ve been writing a lot of Swift and SwiftUI lately, here&rsquo;s what I have learned"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ellie.wtf/post/"},{"@type":"ListItem","position":2,"name":"Lessons learned with Swift + iOS development","item":"https://ellie.wtf/lessons-learned-with-swift-ios-development/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Lessons learned with Swift + iOS development","name":"Lessons learned with Swift \u002b iOS development","description":"I\u0026rsquo;ve been writing a lot of Swift and SwiftUI lately, here\u0026rsquo;s what I have learned","keywords":[],"articleBody":"I‚Äôd like to start this off by saying that I am in no means an expert. While I have been programming for a long time, I‚Äôm new to the world of Swift and iOS, and have never built a mobile app :) This is everything I‚Äôve stumbled upon and learned while building the first iOS version of Pillion!\nPillion is an app to aid in finding motorcycle parking - I‚Äôve got maybe 10,000 parking locations listed all over the world, some sourced from OpenStreetMaps, some from online datasets, and the rest from usersOther than parking, it also provides ride tracking\nA lot of it was found while I was still figuring things out, so in a bunch of cases I wasn‚Äôt doing things in the ‚Äúcorrect‚Äù way. Where I‚Äôve learned better, I‚Äôve included both approaches.\nI might write posts going into more detail on each section (MapBox especially) in the future, if this is well received.\nPlease let me know if you notice any mistakes üòä\nSwiftUI I went straight in for using SwiftUI, the new UI system that Apple released with iOS 13. The caveat here is that only devices running iOS \u003e= 13 are supported - though this is everything since the iPhone 6S.\nSeeing as I‚Äôve been using React for years, SwiftUI feels very nice. While it has differences, components/children/state in ways that feel natural. I actually prefer the state binding to how React handles state, and find that the code feels a decent bit cleaner.\nI never tried UIKit so I don‚Äôt really have much to compare to, but from what I have seen of SwiftUI, it is much cleaner.\nI have had a few issues with SwiftUI that seem to mostly be related to its immaturity - I cover this below.\nAnnoyingly most of the nice UI components I could find on GitHub were only for UIKit. Maybe I‚Äôll try to wrap them at some point, but the ecosystem for SwiftUI seems a little sparse - reflecting its immaturity very well. Something to bear in mind.\nDebugging The XCode debugger was a nice surprise! While I‚Äôm used to ipdb sessions with Python, I didn‚Äôt expect anything as flexible considering the code was running on my phone + compiled.\nI found the debugger could happily inspect values, evaluate Swift expressions, everything I wanted! Tab completion worked really nicely too. Yay for tooling :)\nIt can occasionally be a little slow, but I suppose that‚Äôs to be expected.\nUI thread stuff A lot of my application is essentially making a request to my API, then rendering the result. I found that attempting to update the UI from a background thread (such as the async handler for a HTTP response) would result in an error. Instead, this pattern should be used:\nDispatchQueue.main.async { // do ui } This makes it super easy to avoid blocking the UI thread üòÅ\nThis was actually something I read very early into using Swift. I‚Äôve since learned that ObservableObjects with some Published properties are more the way to go for fetching and updating stuff, where you can! I‚Äôve left it here just in case it‚Äôs needed though. I‚Äôm still not that happy with how HTTP requests are handled in my project so it‚Äôs probably something I am going to revisit in the future.\nKeyboard hiding Just a small thing, but I wanted to be able to hide the keyboard on certain interactions. For instance, when a search bar is focused and you touch an item in the list, hide the keyboard.\nextension UIApplication { func hideKeyboard() { sendAction(#selector(UIResponder.resignFirstResponder), to: nil, from: nil, for: nil) } } UIApplication.shared.hideKeyboard() Just Making HTTP requests in Swift isn‚Äôt too bad, but I‚Äôm used to requests in Python - so I looked for something similar.\nJust seemed to fit that bill! It‚Äôs nice, small, fast, and let‚Äôs you write things like this:\nJust.get(\"https://example.com\") { r in print(r.text) } ‚Ä¶which is super nice!\nIt also lets you setup a session that has headers pre-set, which is useful for authorised HTTP requests\nMapbox I‚Äôve been working with the MapBox Maps SDK for iOS for a large part of this project. Mapbox was a joy to work with in JavaScript, but frankly the iOS side is a little lacking. It can be awkward to customise things, and the documentation isn‚Äôt the best. I often found multiple ways to do something, with little explanation as to why. Seems like Android might be a bit better here though!\nI‚Äôm not saying it‚Äôs bad, just that it feels a tad unfinished or underdeveloped in comparison to the JS solution - and from what I‚Äôve seen of the Android version, compared to that too. I‚Äôll do a comparison once I‚Äôve built the Android app.\nSomething else here is that some of the docs are more for UIKit - makes sense as SwiftUI is so new! Just something to bear in mind. There are some docs that show you how to wrap your map for SwiftUI though\nSwift Typechecking Coming from Rust, the Swift typechecker feels a little‚Ä¶ lacking. Occasionally it flat out fails to infer a seemingly obvious type, or takes too long and asks the developer to break the code down a bit. Not really a huge problem, but it is a bit annoying. Apparently this is constantly improving though!\nIn some cases it will highlight an error in one location, when there are no issues there. Deleting the code will show the actual underlying issue. I think this is more to do with the SwiftUI DSL. When there is a type error within the DSL, if it can‚Äôt infer the type then it just kinda falls apart. I can‚Äôt find a good example right now, but will update this when I do.\nAfter updating to Catalina and the latest XCode, I had a bunch of weird ‚Äúambiguous member‚Äù errors that never existed before the upgrade. Swift seems to have a tendency to give misleading error messages, which is‚Ä¶ strange. I‚Äôve never used another modern language that does the same thing, especially not one backed by such a large company.\nI found I eventually got better at writing code that Swift could understand, even though what I was writing before was, as far as I know, semantically correct.\nSwiftFormat I‚Äôm used to having formatters with other projects, so I looked for one here too. SwiftFormat seems to work nicely\nSwiftUI DSL issues So with SwiftUI View bodies are declared with a little DSL-type-thing\nvar body: some View { ComponentOne { AnotherOne { // so much nesting :O } } } ‚Ä¶which is all well and good.\nHowever, when you want to get into conditional rendering, the DSL doesn‚Äôt seem quite there yet.\nif thing.ouch { RenderMe(thing.ouch.thing) } However, things such as if let, at time of writing, do not work\nif let o = thing.ouch { RenderMe(o.thing) } Not essential, but would be nice!\nThere are a few other small issues here and there with the DSL that still need sorting, but SwiftUI is very new/beta so I‚Äôm not surprised there. Other than the issues, it is a joy to work with. When it works, it works really nicely! It‚Äôs just when it doesn‚Äôt ;)\nAuth0 I‚Äôm currently using Auth0 lock, with Google + Apple oauth login. I‚Äôm actually using my own solution now instead, but I‚Äôve left this here as it‚Äôs still relevant.\nThe Apple one is actually really cool! Users can choose to have an Apple forwarding address to hide their email, and login with FaceID.\nLock wasn‚Äôt setup for SwiftUI, but it‚Äôs pretty easy to wrap:\nstruct Auth0Lock: UIViewControllerRepresentable { typealias UIViewControllerType = LockViewController var lock: Lock = Lock.passwordless().withOptions { $0.passwordlessMethod = .magicLink } .onAuth { credentials in print(credentials) // save access token and use it to do stuff :) } .onError{ error in print(error) // you should probably do something other than just print errors } func makeUIViewController(context: UIViewControllerRepresentableContext\u003cAuth0Lock\u003e) -\u003e LockViewController { return lock.controller } func updateUIViewController(_ uiViewController: LockViewController, context: UIViewControllerRepresentableContext\u003cAuth0Lock\u003e) { // there isn't really much updating I need to do atm } } Auth0 comes with a credential manager that handles refresh tokens, requesting new access tokens, saving and validating tokens, etc. So you don‚Äôt really need to put a lot of work in to keep your users logged in!\njust to elaborate slightly on why I dropped Auth0I wanted more flexibility with how auth was handled, and I ended up rewriting my backend as a Django app - so it was pretty easy for me to just integrate with what Django already has.I switched to Django so I could build the product faster, and not spend time thinking about fun architecture things\nApple developer Signing up for an Apple Developer account for my company (Pillion Software Ltd) took maybe a week or two - filling in the online forms was fast, but it took a little while to get approved + they had to call me. All good after that though!\nI tried to use Fastlane to take screenshots, but found that the simulators/tests didn‚Äôt work very well (mapbox crashing in UI tests) so the only workable way was for me to just take a few manually. Not great, and I‚Äôd like to sort that. I‚Äôll get around to it eventually. It also doesn‚Äôt help that my laptop is super slow + a bit old (mostly lacking in RAM), so the simulator is really crappy.\nI was told after my first app store submission that my app didn‚Äôt have enough functionality. Ouch. After some research, it seems like anything that could be a web app, Apple aren‚Äôt that keen on approving. So instead I just brought some things forward in my roadmap.\nI actually had a version of my app go through the entire review process (from me pressing ‚Äúsubmit‚Äù to it being live) in about 7 minutes, which I was very impressed with.\nConclusions In hindsight I think I‚Äôd probably research other solutions before diving in to using the same tech as I did for my old web version. Maybe MapKit would have done the job just fine and I wouldn‚Äôt have used MapBox.\nI did learn a lot in this process though, so I don‚Äôt think I‚Äôd change too much. I‚Äôll be starting on building the same thing for Android soon (and I don‚Äôt really know any Android dev yet either ;P) so we will see how that goes! Expect a post similar to this one.\nAnyway, Pillion is now in the App Store!\nIf you bike, and decide to give it a go, I‚Äôd love to know what you think - so please don‚Äôt hesitate to get in touch!\n","wordCount":"1776","inLanguage":"en","datePublished":"2020-01-29T14:00:13Z","dateModified":"2020-01-29T14:00:13Z","author":{"@type":"Person","name":"Ellie Huxtable"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ellie.wtf/lessons-learned-with-swift-ios-development/"},"publisher":{"@type":"Organization","name":"Ellie's Blog","logo":{"@type":"ImageObject","url":"https://ellie.wtf/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ellie.wtf/ accesskey=h title="Home (Alt + H)"><img src=https://ellie.wtf/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://plausible.io/ellie.wtf title=analytics><span>analytics</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://hachyderm.io/@ellie title=mastodon><span>mastodon</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><script defer data-domain=ellie.wtf src=https://plausible.io/js/script.js></script><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://ellie.wtf/>Home</a>&nbsp;¬ª&nbsp;<a href=https://ellie.wtf/post/>Posts</a></div><h1 class=post-title>Lessons learned with Swift + iOS development</h1><div class=post-meta><span title='2020-01-29 14:00:13 +0000 UTC'>January 29, 2020</span>&nbsp;¬∑&nbsp;9 min&nbsp;¬∑&nbsp;1776 words&nbsp;¬∑&nbsp;Ellie Huxtable&nbsp;|&nbsp;<a href=https://github.com/ellie/ellie.github.io/post/2020-01-29-lessons-learned-with-swift-ios-development.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#swiftui>SwiftUI</a></li><li><a href=#debugging>Debugging</a></li><li><a href=#ui-thread-stuff>UI thread stuff</a></li><li><a href=#keyboard-hiding>Keyboard hiding</a></li><li><a href=#just>Just</a></li><li><a href=#mapbox>Mapbox</a></li><li><a href=#swift-typechecking>Swift Typechecking</a></li><li><a href=#swiftformat>SwiftFormat</a></li><li><a href=#swiftui-dsl-issues>SwiftUI DSL issues</a></li><li><a href=#auth0>Auth0</a></li><li><a href=#apple-developer>Apple developer</a></li><li><a href=#conclusions>Conclusions</a></li></ul></nav></div></details></div><div class=post-content><p>I&rsquo;d like to start this off by saying that I am <em>in no means an expert</em>. While I have been programming for a long time, I&rsquo;m new to the world of Swift and iOS, and have never built a mobile app :) This is everything I&rsquo;ve stumbled upon and learned while building the first iOS version of <a href=https://pillion.bike>Pillion</a>!</p><blockquote><p>Pillion is an app to aid in finding motorcycle parking - I&rsquo;ve got maybe 10,000 parking locations listed all over the world, some sourced from OpenStreetMaps, some from online datasets, and the rest from usersOther than parking, it also provides ride tracking</p></blockquote><p>A lot of it was found while I was still figuring things out, so in a bunch of cases I wasn&rsquo;t doing things in the &ldquo;correct&rdquo; way. Where I&rsquo;ve learned better, I&rsquo;ve included both approaches.</p><p>I might write posts going into more detail on each section (MapBox especially) in the future, if this is well received.</p><p>Please let me know if you notice any mistakes üòä</p><h2 id=swiftui>SwiftUI<a hidden class=anchor aria-hidden=true href=#swiftui>#</a></h2><p>I went straight in for using SwiftUI, the new UI system that Apple released with iOS 13. The caveat here is that only devices running iOS >= 13 are supported - though this is everything since the iPhone 6S.</p><p>Seeing as I&rsquo;ve been using React for years, SwiftUI feels very nice. While it has differences, components/children/state in ways that feel natural. I actually prefer the state binding to how React handles state, and find that the code feels a decent bit cleaner.</p><p>I never tried UIKit so I don&rsquo;t really have much to compare to, but from what I have seen of SwiftUI, it is much cleaner.</p><p>I have had a few issues with SwiftUI that seem to mostly be related to its immaturity - I cover this below.</p><p>Annoyingly most of the nice UI components I could find on GitHub were only for UIKit. Maybe I&rsquo;ll try to wrap them at some point, but the ecosystem for SwiftUI seems a little sparse - reflecting its immaturity very well. Something to bear in mind.</p><h2 id=debugging>Debugging<a hidden class=anchor aria-hidden=true href=#debugging>#</a></h2><p>The XCode debugger was a nice surprise! While I&rsquo;m used to <code>ipdb</code> sessions with Python, I didn&rsquo;t expect anything as flexible considering the code was running on my phone + compiled.</p><p>I found the debugger could happily inspect values, evaluate Swift expressions, everything I wanted! Tab completion worked really nicely too. Yay for tooling :)</p><p>It can occasionally be a little slow, but I suppose that&rsquo;s to be expected.</p><h2 id=ui-thread-stuff>UI thread stuff<a hidden class=anchor aria-hidden=true href=#ui-thread-stuff>#</a></h2><p>A lot of my application is essentially making a request to my API, then rendering the result. I found that attempting to update the UI from a background thread (such as the async handler for a HTTP response) would result in an error. Instead, this pattern should be used:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Swift data-lang=Swift><span class=line><span class=cl><span class=n>DispatchQueue</span><span class=p>.</span><span class=n>main</span><span class=p>.</span><span class=n>async</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// do ui</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>This makes it super easy to avoid blocking the UI thread üòÅ</p><p>This was actually something I read very early into using Swift. I&rsquo;ve since learned that <code>ObservableObjects</code> with some <code>Published</code> properties are more the way to go for fetching and updating stuff, where you can! I&rsquo;ve left it here just in case it&rsquo;s needed though. I&rsquo;m still not that happy with how HTTP requests are handled in my project so it&rsquo;s probably something I am going to revisit in the future.</p><h2 id=keyboard-hiding>Keyboard hiding<a hidden class=anchor aria-hidden=true href=#keyboard-hiding>#</a></h2><p>Just a small thing, but I wanted to be able to hide the keyboard on certain interactions. For instance, when a search bar is focused and you touch an item in the list, hide the keyboard.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Swift data-lang=Swift><span class=line><span class=cl><span class=kd>extension</span> <span class=nc>UIApplication</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>func</span> <span class=nf>hideKeyboard</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>sendAction</span><span class=p>(</span><span class=k>#selector</span><span class=p>(</span><span class=n>UIResponder</span><span class=p>.</span><span class=n>resignFirstResponder</span><span class=p>),</span> <span class=n>to</span><span class=p>:</span> <span class=kc>nil</span><span class=p>,</span> <span class=n>from</span><span class=p>:</span> <span class=kc>nil</span><span class=p>,</span> <span class=k>for</span><span class=p>:</span> <span class=kc>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-Swift data-lang=Swift><span class=line><span class=cl><span class=n>UIApplication</span><span class=p>.</span><span class=n>shared</span><span class=p>.</span><span class=n>hideKeyboard</span><span class=p>()</span>
</span></span></code></pre></div><h2 id=just>Just<a hidden class=anchor aria-hidden=true href=#just>#</a></h2><p>Making HTTP requests in Swift isn&rsquo;t too bad, but I&rsquo;m used to <code>requests</code> in Python - so I looked for something similar.</p><p><a href=https://github.com/dduan/Just>Just</a> seemed to fit that bill! It&rsquo;s nice, small, fast, and let&rsquo;s you write things like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Swift data-lang=Swift><span class=line><span class=cl><span class=n>Just</span><span class=p>.</span><span class=kr>get</span><span class=p>(</span><span class=s>&#34;https://example.com&#34;</span><span class=p>)</span> <span class=p>{</span> <span class=n>r</span> <span class=k>in</span>
</span></span><span class=line><span class=cl>	<span class=bp>print</span><span class=p>(</span><span class=n>r</span><span class=p>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>&mldr;which is super nice!</p><p>It also lets you setup a session that has headers pre-set, which is useful for authorised HTTP requests</p><h2 id=mapbox>Mapbox<a hidden class=anchor aria-hidden=true href=#mapbox>#</a></h2><p>I&rsquo;ve been working with the <a href=https://docs.mapbox.com/ios/api/maps/5.4.0/>MapBox Maps SDK for iOS</a> for a large part of this project. Mapbox was a joy to work with in JavaScript, but frankly the iOS side is a little lacking. It can be awkward to customise things, and the documentation isn&rsquo;t the best. I often found multiple ways to do something, with little explanation as to why. Seems like Android might be a bit better here though!</p><p>I&rsquo;m not saying it&rsquo;s <em>bad</em>, just that it feels a tad unfinished or underdeveloped in comparison to the JS solution - and from what I&rsquo;ve seen of the Android version, compared to that too. I&rsquo;ll do a comparison once I&rsquo;ve built the Android app.</p><p>Something else here is that some of the docs are more for UIKit - makes sense as SwiftUI is so new! Just something to bear in mind. There are some docs that show you how to wrap your map for SwiftUI though</p><h2 id=swift-typechecking>Swift Typechecking<a hidden class=anchor aria-hidden=true href=#swift-typechecking>#</a></h2><p>Coming from Rust, the Swift typechecker feels a little&mldr; lacking. Occasionally it flat out fails to infer a seemingly obvious type, or takes too long and asks the developer to break the code down a bit. Not really a huge problem, but it is a bit annoying. Apparently this is constantly improving though!</p><p>In some cases it will highlight an error in one location, when there are no issues there. Deleting the code will show the actual underlying issue. I think this is more to do with the SwiftUI DSL. When there is a type error within the DSL, if it can&rsquo;t infer the type then it just kinda falls apart. I can&rsquo;t find a good example right now, but will update this when I do.</p><p>After updating to Catalina and the latest XCode, I had a bunch of weird &ldquo;ambiguous member&rdquo; errors that never existed before the upgrade. Swift seems to have a tendency to give misleading error messages, which is&mldr; strange. I&rsquo;ve never used another modern language that does the same thing, especially not one backed by such a large company.</p><p>I found I eventually got better at writing code that Swift could understand, even though what I was writing before was, as far as I know, semantically correct.</p><h2 id=swiftformat>SwiftFormat<a hidden class=anchor aria-hidden=true href=#swiftformat>#</a></h2><p>I&rsquo;m used to having formatters with other projects, so I looked for one here too. <a href=https://github.com/nicklockwood/SwiftFormat>SwiftFormat</a> seems to work nicely</p><h2 id=swiftui-dsl-issues>SwiftUI DSL issues<a hidden class=anchor aria-hidden=true href=#swiftui-dsl-issues>#</a></h2><p>So with SwiftUI <code>View</code> bodies are declared with a little DSL-type-thing</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Swift data-lang=Swift><span class=line><span class=cl><span class=kd>var</span> <span class=nv>body</span><span class=p>:</span> <span class=n>some</span> <span class=n>View</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=n>ComponentOne</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    	<span class=n>AnotherOne</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        	<span class=c1>// so much nesting :O</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>&mldr;which is all well and good.</p><p>However, when you want to get into conditional rendering, the DSL doesn&rsquo;t seem quite there yet.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Swift data-lang=Swift><span class=line><span class=cl><span class=k>if</span> <span class=n>thing</span><span class=p>.</span><span class=n>ouch</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=n>RenderMe</span><span class=p>(</span><span class=n>thing</span><span class=p>.</span><span class=n>ouch</span><span class=p>.</span><span class=n>thing</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>However, things such as <code>if let</code>, at time of writing, do not work</p><pre tabindex=0><code>if let o = thing.ouch {
	RenderMe(o.thing)
}
</code></pre><p>Not essential, but would be nice!</p><p>There are a few other small issues here and there with the DSL that still need sorting, but SwiftUI is very new/beta so I&rsquo;m not surprised there. Other than the issues, it is a joy to work with. When it works, it works really nicely! It&rsquo;s just when it doesn&rsquo;t ;)</p><h2 id=auth0>Auth0<a hidden class=anchor aria-hidden=true href=#auth0>#</a></h2><p>I&rsquo;m currently using Auth0 lock, with Google + Apple oauth login. I&rsquo;m actually using my own solution now instead, but I&rsquo;ve left this here as it&rsquo;s still relevant.</p><p>The Apple one is actually really cool! Users can choose to have an Apple forwarding address to hide their email, and login with FaceID.</p><p>Lock wasn&rsquo;t setup for SwiftUI, but it&rsquo;s pretty easy to wrap:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Swift data-lang=Swift><span class=line><span class=cl><span class=kd>struct</span> <span class=nc>Auth0Lock</span><span class=p>:</span> <span class=n>UIViewControllerRepresentable</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>typealias</span> <span class=n>UIViewControllerType</span> <span class=p>=</span> <span class=n>LockViewController</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nv>lock</span><span class=p>:</span> <span class=n>Lock</span> <span class=p>=</span> <span class=n>Lock</span><span class=p>.</span><span class=n>passwordless</span><span class=p>().</span><span class=n>withOptions</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$0</span><span class=p>.</span><span class=n>passwordlessMethod</span> <span class=p>=</span> <span class=p>.</span><span class=n>magicLink</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>onAuth</span> <span class=p>{</span> <span class=n>credentials</span> <span class=k>in</span>
</span></span><span class=line><span class=cl>        <span class=bp>print</span><span class=p>(</span><span class=n>credentials</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>// save access token and use it to do stuff :)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>onError</span><span class=p>{</span> <span class=n>error</span> <span class=k>in</span>
</span></span><span class=line><span class=cl>        <span class=bp>print</span><span class=p>(</span><span class=n>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>// you should probably do something other than just print errors</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>func</span> <span class=nf>makeUIViewController</span><span class=p>(</span><span class=n>context</span><span class=p>:</span> <span class=n>UIViewControllerRepresentableContext</span><span class=p>&lt;</span><span class=n>Auth0Lock</span><span class=p>&gt;)</span> <span class=p>-&gt;</span> <span class=n>LockViewController</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>lock</span><span class=p>.</span><span class=n>controller</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>func</span> <span class=nf>updateUIViewController</span><span class=p>(</span><span class=kc>_</span> <span class=n>uiViewController</span><span class=p>:</span> <span class=n>LockViewController</span><span class=p>,</span> <span class=n>context</span><span class=p>:</span> <span class=n>UIViewControllerRepresentableContext</span><span class=p>&lt;</span><span class=n>Auth0Lock</span><span class=p>&gt;)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// there isn&#39;t really much updating I need to do atm</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Auth0 comes with a credential manager that handles refresh tokens, requesting new access tokens, saving and validating tokens, etc. So you don&rsquo;t really need to put a lot of work in to keep your users logged in!</p><blockquote><p>just to elaborate slightly on why I dropped Auth0I wanted more flexibility with how auth was handled, and I ended up rewriting my backend as a Django app - so it was pretty easy for me to just integrate with what Django already has.I switched to Django so I could build the product faster, and not spend time thinking about fun architecture things</p></blockquote><h2 id=apple-developer>Apple developer<a hidden class=anchor aria-hidden=true href=#apple-developer>#</a></h2><p>Signing up for an Apple Developer account for my company (Pillion Software Ltd) took maybe a week or two - filling in the online forms was fast, but it took a little while to get approved + they had to call me. All good after that though!</p><p>I tried to use Fastlane to take screenshots, but found that the simulators/tests didn&rsquo;t work very well (mapbox crashing in UI tests) so the only workable way was for me to just take a few manually. Not great, and I&rsquo;d like to sort that. I&rsquo;ll get around to it eventually. It also doesn&rsquo;t help that my laptop is super slow + a bit old (mostly lacking in RAM), so the simulator is really crappy.</p><p>I was told after my first app store submission that my app didn&rsquo;t have enough functionality. Ouch. After some research, it seems like anything that <em>could</em> be a web app, Apple aren&rsquo;t that keen on approving. So instead I just brought some things forward in my roadmap.</p><p>I actually had a version of my app go through the entire review process (from me pressing &ldquo;submit&rdquo; to it being live) in about 7 minutes, which I was very impressed with.</p><h2 id=conclusions>Conclusions<a hidden class=anchor aria-hidden=true href=#conclusions>#</a></h2><p>In hindsight I think I&rsquo;d probably research other solutions before diving in to using the same tech as I did for my old web version. Maybe MapKit would have done the job just fine and I wouldn&rsquo;t have used MapBox.</p><p>I did learn a lot in this process though, so I don&rsquo;t think I&rsquo;d change too much. I&rsquo;ll be starting on building the same thing for Android soon (and I don&rsquo;t really know any Android dev yet either ;P) so we will see how that goes! Expect a post similar to this one.</p><p>Anyway, <a href=https://pillion.bike/ios>Pillion is now in the App Store!</a></p><p>If you bike, and decide to give it a go, I&rsquo;d love to know what you think - so please don&rsquo;t hesitate to get in touch!</p></div><footer class=post-footer><ul class=post-tags></ul><script src=https://utteranc.es/client.js repo=ellie/ellie.github.io issue-term=title label=comment theme=preferred-color-scheme crossorigin=anonymous async></script><nav class=paginav><a class=prev href=https://ellie.wtf/rest-apis-and-swiftui/><span class=title>¬´ Prev</span><br><span>Rest APIs and SwiftUI</span></a>
<a class=next href=https://ellie.wtf/my-backup-script/><span class=title>Next ¬ª</span><br><span>My backup script</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Lessons learned with Swift + iOS development on twitter" href="https://twitter.com/intent/tweet/?text=Lessons%20learned%20with%20Swift%20%2b%20iOS%20development&amp;url=https%3a%2f%2fellie.wtf%2flessons-learned-with-swift-ios-development%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Lessons learned with Swift + iOS development on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fellie.wtf%2flessons-learned-with-swift-ios-development%2f&amp;title=Lessons%20learned%20with%20Swift%20%2b%20iOS%20development&amp;summary=Lessons%20learned%20with%20Swift%20%2b%20iOS%20development&amp;source=https%3a%2f%2fellie.wtf%2flessons-learned-with-swift-ios-development%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Lessons learned with Swift + iOS development on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fellie.wtf%2flessons-learned-with-swift-ios-development%2f&title=Lessons%20learned%20with%20Swift%20%2b%20iOS%20development"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Lessons learned with Swift + iOS development on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fellie.wtf%2flessons-learned-with-swift-ios-development%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Lessons learned with Swift + iOS development on whatsapp" href="https://api.whatsapp.com/send?text=Lessons%20learned%20with%20Swift%20%2b%20iOS%20development%20-%20https%3a%2f%2fellie.wtf%2flessons-learned-with-swift-ios-development%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Lessons learned with Swift + iOS development on telegram" href="https://telegram.me/share/url?text=Lessons%20learned%20with%20Swift%20%2b%20iOS%20development&amp;url=https%3a%2f%2fellie.wtf%2flessons-learned-with-swift-ios-development%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://ellie.wtf/>Ellie's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>